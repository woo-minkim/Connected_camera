# Luna API 기반 개인화 홈 화면 기능 기획안

## 0. 개요

본 기획은 webOS 기반 TV(StandbyME)에서 Luna API와 카메라를 활용하여 다음 세 가지 기능을 제공하는 것을 목표로 한다.

1. **시청 인원 수 기반 홈 화면 구성 (SOLO / GROUP 모드)**  
   - 로그인/홈 진입 단계에서 얼굴 개수(faceCount)를 인식해  
     - SOLO일 때: Netflix / YouTube 2분할 홈 화면  
     - GROUP일 때: 함께 보기 좋은 콘텐츠 중심 홈 화면  
2. **사용자와 화면 거리 기반 밝기·UI 크기 자동 조절**  
   - 얼굴 크기(w, h)를 활용해 가까움/보통/멀음을 판단하고 밝기·UI 스케일을 조정  
3. **영상 시청 중 시청자 미감지 시 자동 일시정지**  
   - 재생 중 얼굴이 일정 시간 이상 감지되지 않으면 자동으로 영상을 정지

이 세 기능은 모두 Luna API가 제공하는 **faceCount + 얼굴 위치/크기 정보(faces 배열)**들을 사용하여 구현하는 것을 전제로 한다.

---

## 1. 공통 전제 및 Luna API 활용 범위

### 1.1 사용 데이터

- `faceCount`  
  - 현재 화면에 인식된 얼굴 개수
- `faces` 배열  
  - 각 얼굴의 위치와 크기 정보 (x, y, w, h, confidence 등)
  - 여기서 w, h로 **거리 추정**, x로 **좌우 위치**를 유추

### 1.2 기본 동작 타이밍

- TV 전원 ON 또는 홈 화면 진입 시점에 다음을 수행:
  - 얼굴 인식 모델 설치(최초 1회) 및 카메라 초기화
  - FaceDetection 솔루션 활성화
  - `getEventNotification` 구독 시작  
- 이후 모든 기능(1, 2, 3)은 이 얼굴 인식 스트림을 공통으로 사용

---

## 2. 기능 1: 시청 인원 수 기반 홈 화면 구성

### 2.1 목적

- 로그인/홈 첫 화면에서 사용자의 사용 패턴(대부분 Netflix/YouTube 시청)을 반영해  
  **SOLO일 때는 "나 혼자 보는 화면", GROUP일 때는 "여럿이 함께 보는 화면"**을 제공한다.
- 리모컨 조작 없이도 전원을 켜자마자 “바로 쓸 수 있는 홈 화면”을 구현하는 것을 목표로 한다.

### 2.2 상태 정의

- `SOLO 모드`: faceCount = 1
- `GROUP 모드`: faceCount ≥ 2
- `IDLE 상태`: faceCount = 0  
  - 로그인 대기, 절전 후보 상태에서만 활용

### 2.3 동작 흐름

1. **TV 전원 ON / 홈 진입**
   - 카메라 + FaceDetection 활성화
   - 짧은 시간(예: 1~2초) 동안 faceCount를 수집

2. **시청 인원 판단**
   - faceCount = 0 → 기본 홈 / 로그인 대기 상태
   - faceCount = 1 → SOLO 모드
   - faceCount ≥ 2 → GROUP 모드

3. **홈 화면 구성 분기**
   - SOLO:
     - 화면 좌측: Netflix 영역
     - 화면 우측: YouTube 영역
   - GROUP:
     - 동일한 2분할 구조를 유지하되,  
       - “다 같이 보기 좋은 콘텐츠” 리스트 중심으로 카드 구성

※ 실제 Netflix/YouTube 내부의 개인 추천 데이터를 직접 연동하기 어렵다면,  
   데모에서는 **“가상의 추천 카드”**를 UI 레벨에서 구성하는 방향으로 진행한다.  
   예)  
   - “최근 본 콘텐츠” 카드는 더미 데이터  
   - “새로운 업데이트” 카드는 고정된 샘플 썸네일

### 2.4 SOLO 모드 화면 기획

- **좌측 영역 – Netflix 블록**
  - 타이틀: “혼자 보는 추천 콘텐츠”
  - 카드 리스트 예:
    - 최근 시청한 콘텐츠 (가상의 데이터)
    - “이어보기” 형태 카드
- **우측 영역 – YouTube 블록**
  - 타이틀: “구독 채널 새 영상”
  - 카드 리스트 예:
    - 자주 보는 카테고리(게임, 음악, 브이로그 등)를 모사한 썸네일

### 2.5 GROUP 모드 화면 기획

- **좌측 영역 – “함께 보는 OTT”**
  - 넷플릭스 파티용 콘텐츠, 가족·친구와 보기 좋은 장르 위주 카드
- **우측 영역 – “다 같이 즐길 콘텐츠”**
  - YouTube 파티용 영상, 파티 게임, 퀴즈 영상 등 컨셉의 카드
- 상단 상단 문구 예:
  - “지금은 함께 보는 시간입니다”
  - “여러 명이 같이 보기 좋은 콘텐츠를 모아봤어요”

### 2.6 IDLE 상태

- faceCount = 0이 일정 시간 이상 지속될 때:
  - SOLO/GROUP 모드 대신 간단한 기본 홈 화면 유지
  - 시계, 날씨, 안내 문구 등만 표시
  - 다른 기능(밝기 조절, 자동 정지)과 연계 가능

---

## 3. 기능 2: 사용자 거리 기반 밝기·UI 크기 자동 조절

### 3.1 목적

- 사용자가 화면에 **얼마나 가까이 앉아 있는지**에 따라
  - 눈부심을 줄이고,
  - 가독성을 높이며,
  - 장시간 시청 시 피로를 줄이는 “자동 화면 최적화” 제공

### 3.2 거리 추정 방식

- `faces[0].w`, `faces[0].h` (첫 번째 얼굴의 bounding box 크기)를 사용
- 얼굴 크기가 크면: 카메라와의 거리가 가깝다  
- 얼굴 크기가 작으면: 카메라와의 거리가 멀다

### 3.3 거리 단계 정의 (예시)

- **NEAR (가까움)**  
  - w, h가 기준값 이상  
- **MID (보통)**  
  - 중간 범위  
- **FAR (멀리)**  
  - w, h가 기준값 이하

정확한 수치는 실측 또는 테스트를 통해 조정.

### 3.4 밝기 및 UI 크기 정책

- **NEAR**
  - 화면 밝기: 낮음
  - UI 크기: 작음 (한 화면에 더 많은 정보 가능)
- **MID**
  - 화면 밝기: 중간
  - UI 크기: 기본값
- **FAR**
  - 화면 밝기: 높음
  - UI 크기: 큼 (멀리서도 잘 보이도록)

### 3.5 동작 흐름

1. 얼굴 인식 결과 수신 시마다 현재 얼굴 크기 측정
2. 거리 단계(NEAR/MID/FAR) 계산
3. 이전 단계와 비교해 변경이 필요할 때만 화면 밝기·UI 스케일 조정
   - 불필요한 깜빡임을 막기 위해 작은 변화는 무시
4. 거리 변화가 과도하게 잦을 경우,
   - 일정 시간 동안 같은 단계가 유지될 때만 실제 적용

---

## 4. 기능 3: 얼굴 미감지 시 영상 자동 정지

### 4.1 목적

- 사용자가 영상을 시청하다 자리에서 일어나거나, TV를 두고 나간 상황에서  
  **영상이 계속 재생되는 낭비와 위험을 줄이는 것**이 목표
- 실사용 관점에서도 납득 가능한 UX:  
  “시청자가 없으면 자동으로 일시정지”

### 4.2 적용 대상

- Netflix, YouTube 등 동영상 재생 화면
- 내부 데모용 영상 플레이어

### 4.3 동작 조건

1. 현재 앱 상태가 “영상 재생 중”
2. faceCount가 0인 상태가 일정 시간 이상 지속
   - 예: 5초, 10초 등 (실험으로 결정)

### 4.4 동작 흐름

1. **영상 재생 중**  
   - Luna 얼굴 인식은 백그라운드에서 계속 동작

2. **얼굴 미감지 상태 감지**
   - faceCount = 0 발생
   - 타이머 시작 (예: 10초)

3. **유지 시간 체크**
   - 10초 동안 faceCount가 계속 0이면 → “시청자 없음”으로 판단
   - 중간에 다시 faceCount > 0이 되면 타이머 리셋

4. **자동 일시정지 실행**
   - 현재 재생 중인 영상을 일시정지
   - 화면 상단 또는 중앙에 다음 안내 배너 표시:
     - “시청자가 감지되지 않아 영상을 일시정지했습니다.”
     - “다시 보시려면 재생 버튼을 눌러주세요.”

5. **사용자가 돌아왔을 때**
   - 다시 faceCount > 0
   - 바로 자동 재생은 하지 않고,
     - 작은 팝업으로 “이어보기” 버튼 제공
     - 사용자가 명시적으로 재생을 눌렀을 때 다시 진행

---

## 5. 세 기능 간 관계 및 우선순위

### 5.1 공통 기반

- 세 기능 모두 공통적으로 다음 요소를 사용한다.
  - faceCount
  - faces[0].w, h (거리 추정용)

### 5.2 우선 구현 순서

1. **기능 3 – 자동 정지**  
   - 로직이 가장 단순하고, 데모 효과가 확실함
2. **기능 1 – SOLO/GROUP 홈 화면**  
   - 메인 기획 포인트.  
   - 홈 화면과 연계되어 프로젝트의 “대표 기능” 역할
3. **기능 2 – 거리 기반 밝기·UI 크기 조절**  
   - UX 개선 기능으로 추가하면 완성도 상승

---

## 6. 요약

- 로그인/홈 단계에서 Luna API로 시청 인원 수를 인식해  
  **SOLO → Netflix/YouTube 2분할 개인 모드**,  
  **GROUP → 함께 보기 좋은 콘텐츠 2분할 그룹 모드**를 제공한다.
- 같은 얼굴 인식 결과에서 얼굴 크기를 이용해  
  **밝기와 UI 크기를 자동 조절**한다.
- 영상 시청 중 얼굴이 일정 시간 감지되지 않으면  
  **자동으로 영상을 일시정지**하여 사용자 편의성과 안전성을 높인다.

이 세 가지 기능을 통해,  
“TV가 카메라와 Luna API를 통해 상황을 이해하고, 그에 맞게 홈 화면과 시청 경험을 바꾸는 시스템”이라는 메시지를 명확하게 전달할 수 있다.
